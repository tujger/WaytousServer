{
  "rules": {
    ".read": "auth.uid === 'Administrator' || auth.uid === 'Viewer'",
    ".write": "auth.uid === 'Administrator'",
    "_groups":{
      ".read": false,
      ".write": false
    },
    "_stat": {
      ".write": false
    },
    "_users": {
      "$user_id": {
        ".read": "$user_id === auth.uid",
        ".write": "$user_id === auth.uid",
        "p": { // user persistent private data
          ".read": false,
          ".write": false
        }
      }
    },
    "$group_id": {
      ".write": false,
      ".validate": "root.child('_groups').child($group_id).exists()",
      //".write": "(auth.uid != null && !data.exists() && newData.exists()) || auth.uid === 'rdvGxl3Yc0boERLyh71Ur8IaMen1'",
      "o": { // options
        ".read": "root.child($group_id+'/u/k/'+auth.uid).exists()",
        ".write": false,
        "welcome-message": {
          ".write": "root.child($group_id+'/u/p/0/uid').val() === auth.uid",
          ".validate": "newData.isString() && newData.val().length < 10240"
        },
        "date-created": {
          ".write": "!data.exists() && newData.exists()"
        },
        "persistent": {
          ".write": "!data.exists() && newData.exists()"
        },
        "requires-password": {
          ".write": "!data.exists() && newData.exists()"
        },
        "time-to-live-if-empty": {
          ".write": "!data.exists() && newData.exists()"
        },
        "dismiss-inactive": {
          ".write": "!data.exists() && newData.exists()"
        },
        "delay-to-dismiss": {
          ".write": "!data.exists() && newData.exists()"
        }
      },
      "u": { // users
        ".read": false,
        ".write": false,
        "n": { // uniqueKey - uid
          ".read": false,
          ".write": false
        },
        "k": { // uid - number
          ".read": false,
          ".write": false
        },
        "b": { // data
          ".read": "root.child($group_id+'/u/k/'+auth.uid).exists()",
          "$user_number":{
            "active": {
              ".write": "root.child($group_id+'/u/p/'+$user_number+'/uid').val() === auth.uid",
              ".validate": "newData.isBoolean()"
            },
            "name": {
              ".write": "root.child($group_id+'/u/p/'+$user_number+'/uid').val() === auth.uid",
              ".validate": "newData.isString() && newData.val().length < 256"
            },
            "ch": {
              ".write": "root.child($group_id+'/u/p/'+$user_number+'/uid').val() === auth.uid",
              ".validate": "newData.val() <= now"
            }
          }
        },
        "p": { // data-private
          ".read": false,
          ".write": false
        }
      },
      "b": { // public
        ".read": "root.child($group_id+'/u/k/'+auth.uid).exists()",
        ".write": false,
        "$event": {
          "$user_number": {
            ".write": "root.child($group_id+'/u/p/'+$user_number+'/uid').val() === auth.uid",
            "$item_id": {
              ".validate": "(newData.isString() && newData.val().length < 10240) || !newData.isString()",
              "$key_id": {
                ".validate": "(newData.isString() && newData.val().length < 10240) || newData.isNumber() || newData.isBoolean()"
              }
            }
          }
        }
      },
      "p": { // private
        ".read": false,
        ".write": false,
        "$event": {
          "$user_number": {
            ".read": "root.child($group_id+'/u/p/'+$user_number+'/uid').val() === auth.uid",
            "$item_id": {
              ".write": "root.child($group_id+'/u/k/'+auth.uid).exists()",
              ".validate": "(newData.isString() && newData.val().length < 10240) || !newData.isString()",
              "$key_id": {
                ".validate": "(newData.isString() && newData.val().length < 10240) || newData.isNumber() || newData.isBoolean()"
              }
            }
          }
        }
      }
      //    ".read": "root.child($group_id+'/u/'+auth.uid).exists()",
      //    ".write": "root.child($group_id+'/u/'+auth.uid).exists() && newData.child('author_id').val() === auth.uid && !data.exists() && newData.exists()",

    }
  }
}